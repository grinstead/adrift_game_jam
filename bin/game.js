'use strict';class aa{constructor(a,b,c){this.name=c;this.s=`${b}${c}`;switch(a){case "uniform":this.type=1;if("u_"!==b)throw Error(`uniform field "${this.s}" invalid, must start with u_`);break;case "in":this.type=2;if("a_"!==b)throw Error(`in field "${this.s}" invalid, must start with a_`);break;default:throw Error("Impossible");}}}function ba(a){const b=[];a.split("\n").forEach(c=>{(c=/^\s*(in|uniform)\s(?:\w+\s)*([ua]_)(\w+);/.exec(c))&&b.push(new aa(c[1],c[2],c[3]))});return b}
const ca=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function da(a,b){a.a.uniformMatrix4fv(a.c,!1,b);a.b.push(b)}function z(a,b,c,e=0){var d=a.b;d=d.length?d[d.length-1]:ca;da(a,new Float32Array([d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],b*d[0]+c*d[4]+e*d[8]+d[12],b*d[1]+c*d[5]+e*d[9]+d[13],b*d[2]+c*d[6]+e*d[10]+d[14],b*d[3]+c*d[7]+e*d[11]+d[15]]))}function ea(a,b){const c=Math.cos(b);b=Math.sin(b);a.push(new Float32Array([c,0,b,0,0,1,0,0,-b,0,c,0,0,0,0,1]))}
class ja{constructor(a,b){this.a=a;this.c=b;this.b=[];a.uniformMatrix4fv(b,!1,ca)}pop(){return this.b.pop()}push(a){var b=this.b;0===b.length?da(this,a):(b=b[b.length-1],da(this,new Float32Array([a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15],a[4]*b[0]+a[5]*b[4]+a[6]*b[8]+a[7]*b[12],a[4]*b[1]+a[5]*b[5]+a[6]*b[9]+a[7]*b[13],a[4]*b[2]+a[5]*b[6]+a[6]*b[10]+a[7]*b[14],a[4]*b[3]+a[5]*
b[7]+a[6]*b[11]+a[7]*b[15],a[8]*b[0]+a[9]*b[4]+a[10]*b[8]+a[11]*b[12],a[8]*b[1]+a[9]*b[5]+a[10]*b[9]+a[11]*b[13],a[8]*b[2]+a[9]*b[6]+a[10]*b[10]+a[11]*b[14],a[8]*b[3]+a[9]*b[7]+a[10]*b[11]+a[11]*b[15],a[12]*b[0]+a[13]*b[4]+a[14]*b[8]+a[15]*b[12],a[12]*b[1]+a[13]*b[5]+a[14]*b[9]+a[15]*b[13],a[12]*b[2]+a[13]*b[6]+a[14]*b[10]+a[15]*b[14],a[12]*b[3]+a[13]*b[7]+a[14]*b[11]+a[15]*b[15]])))}}
class ka{constructor(a,b){this.name=a.name;var c=this.a=a.a;a=this.type=a.type;switch(a){case "vertex":var e=this.a.VERTEX_SHADER;break;case "fragment":e=this.a.FRAGMENT_SHADER;break;default:throw Error(`Unrecognized shader type "${a}"`);}e=this.b=c.createShader(e);c.shaderSource(e,b);c.compileShader(e);if(!c.getShaderParameter(e,c.COMPILE_STATUS))throw b=`Failed to compile ${this.name} ${a}-shader: ${c.getShaderInfoLog(e)}`,c.deleteShader(e),Error(b);this.ua=ba(b)}}
function la(a,...b){const c=a.a,e=a.T;b.forEach(d=>{a.ca.push(d);c.attachShader(e,d.b)});return a}class ma{constructor(a){this.name=a.name;this.P=a.P;a=this.a=a.a;this.b=!1;this.T=a.createProgram();this.ca=[];this.l={};this.m={};this.stack=null}link(){if(this.b)return this;var a=this.a,b=this.T;a.linkProgram(b);if(!a.getProgramParameter(b,a.LINK_STATUS)){var c=`Failed to link ${this.name} program: ${a.getProgramInfoLog(b)}`;a.deleteProgram(b);throw Error(c);}this.b=!0;return this}}
function ua(a,b){var c=a.a,e=a.T;c.useProgram(e);for(var d={},f={},h=a.ca,g=0;g<h.length;g++)for(var k=h[g].ua,l=0;l<k.length;l++){var n=k[l];1===n.type?n.s in d||(d[n.name]=c.getUniformLocation(e,n.s)):n.s in f||(f[n.name]=c.getAttribLocation(e,n.s))}a.l=d;a.m=f;if(e=a.P)if(e in a.l)a.stack=new ja(c,a.l[e]);else throw Error(`No anchor point "${e}" in program`);try{b(c,a)}finally{a.l={},a.m={},a.stack=null}}
class va{constructor(a,b,c,e,d){this.a=a;this.name=b;this.w=c;this.f=e;this.b=d(a)}bindTexture(){this.a.bindTexture(this.a.TEXTURE_2D,this.b)}}function F(a){return(new Promise((b,c)=>{const e=new Image;e.onload=()=>void b(e);e.onerror=()=>{c(Error(`failed to load ${a.src}`))};e.mode="no-cors";e.src=a.src})).then(b=>{const c=b.naturalWidth,e=b.naturalHeight;return new va(a.a,a.name,c,e,wa(d=>{d.texImage2D(d.TEXTURE_2D,0,d.RGBA,c,e,0,d.RGBA,d.UNSIGNED_BYTE,b)}))})}
function xa(a){const b=a.width,c=a.height;return new va(a.a,a.name,b,c,wa(e=>{e.texImage2D(e.TEXTURE_2D,0,e.RGBA,b,c,0,e.RGBA,e.UNSIGNED_BYTE,a.da,0)}))}function ya(a){return new va(a.a,a.name,a.width,a.height,()=>a.Ka)}
function wa(a){return b=>{const c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);a(b);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.bindTexture(b.TEXTURE_2D,null);return c}};function G(a,b){const c=a.b.a;let e=a.c;null!=e?c.bindBuffer(c.ARRAY_BUFFER,e):(a.c=e=c.createBuffer(),c.bindBuffer(c.ARRAY_BUFFER,e),c.bufferData(c.ARRAY_BUFFER,a.H,c.STATIC_DRAW));c.activeTexture(c.TEXTURE0);a.b.bindTexture();c.uniform1i(b.l.texture,0);c.enableVertexAttribArray(b.m.texturePosition);c.vertexAttribPointer(b.m.texturePosition,2,c.FLOAT,!1,20,12);c.enableVertexAttribArray(b.m.position);c.vertexAttribPointer(b.m.position,3,c.FLOAT,!1,20,0)}
function K(a,b,c){if(!a.data.hasOwnProperty(b))throw Error(`Can not render unknown "${b}"`);b=a.data[b];a=a.b.a;const e=b.V;a.drawArrays(a.TRIANGLE_STRIP,e[c%e.length],b.Ea)}
class L{constructor(a,b){this.b=a;this.c=null;a=this.data={};const c=[];let e=0;for(const d in b){const f=b[d],h=[],g=f.length;if(0===g)throw Error("Sprite declared with 0 points");const k=f[0].length;if(0==k)throw Error("Sprite declared with list of length 5 (must be non-zero multiple of 5)");const l=k/5;for(let n=0;n<g;n++){const u=f[n];if(u.length!==k)throw Error("Sprite declared with inconsistent lengths of elements");h.push(e);c.push.apply(c,u);e+=l}a[d]={Ma:this,name:d,V:h,Ea:l}}this.H=new Float32Array(c)}}
class za{constructor(a,b){const c=b.Ca,e=b.ga;this.H=b.name;this.va=b.ha;this.ba=null;this.W="number"===typeof c?c:c?-1:0;this.c=b.set;this.b="number"===typeof e?Array(a).fill(e):e;this.R=0;this.U=this.S=-1}toString(){return`Sprite/${this.H}`}}function Aa(a,b,c){const e=a.b;return b+1===e.length&&a.R===a.W?-1:c+e[b]}
function Ba(a){const b=a.name,c=a.ga,e=a.set.data;let d=-1;a.ha.forEach(f=>{const h=e[f];if(!h)throw Error(`Sprite/${b} has non-existent mode ${f}`);if(-1===d)d=h.V.length;else if(d!==h.V.length)throw Error(`Sprite/${b} has inconsistent frame counts`);});if(-1===d)throw Error(`Sprite/${b} given 0 modes`);if("number"!==typeof c&&c.length!==d)throw Error(`Sprite/${b} given ${c.length} frame times for ${d} frames`);return()=>new za(d,a)}
function Q({D:a=0,Ra:b=0,Sa:c=0,B:e,u:d,v:f,A:h,g,count:k,j:l=!1}){const n=e/f;f=d/f;return Ca({x:a*n,y:b,z:c*f,width:n,height:f,aa:e/h.w,$:d/h.f,g,count:k,j:l})}function Ca({x:a=0,y:b=0,z:c=0,width:e,height:d,aa:f,$:h,g,count:k,Oa:l=0,Pa:n=0,Qa:u=f,Na:y=h,j:r=!1}){const A=[];for(let D=0;D<k;D++){const w=l+D%g*u,U=n+Math.floor(D/g)*y;A.push(Da({x:a,y:b,z:c,width:e,height:d,sa:w,qa:w+f,ta:U,ra:U+h,j:r}))}return A}
function Da({x:a=0,y:b=0,z:c=0,width:e,height:d,sa:f,ta:h,qa:g,ra:k,j:l=!1}){l?l=g:(l=f,f=g);return[e-a,b,-c,f,k,-a,b,-c,l,k,e-a,b,d-c,f,h,-a,b,d-c,l,h]};function R(a,b,c){a=a.c;null!=c?a.set(b,c):a.delete(b)}function Pa(a,b){b=a.c.get(b);const c=a.b;return!!b&&!!b.some(e=>(e=c.get(e))?(e.M=0,null!=e.N):!1)}function Qa(a){const b=a.c.get("showLights");if(b){const c=a.b;return b.reduce((e,d)=>(d=c.get(d))?(e+=d.M,d.M=0,e):e,0)}return 0}function Ra(a,b,c){b=Pa(a,b)?1:0;return(Pa(a,c)?1:0)-b}
class Sa{constructor(a){this.b=new Map;this.c=new Map;a.addEventListener("keydown",b=>{Ta(this,b,!0)});a.addEventListener("keyup",b=>{Ta(this,b,!1)});a.onblur=()=>{this.b.clear()};a.onfocus=()=>{this.b.clear()}}}function Ta(a,b,c){b=b.key;a=a.b;const e=a.get(b);c?null==e?a.set(b,{N:Date.now(),M:1}):(null==e.N&&(e.N=Date.now()),e.M++):null!=e&&(e.N=null)};function Ua(a,b){const c=a.c.a,e=a.b;c.enable(c.BLEND);c.blendFunc(c.ONE,c.ONE);c.bindFramebuffer(c.FRAMEBUFFER,a.W);c.viewport(0,0,e.w,e.f);ua(a.c,(d,f)=>{Va(d,f,a,b)})}
class Wa{constructor(a,b,c,e){b/=4;c/=4;var d=new ka({a,type:"vertex"},"#version 300 es\nin vec3 a_position;\nin vec2 a_texturePosition;\n\nuniform mat4 u_projection;\n\nout vec2 v_texturePosition;\n\nvoid main() {\n  vec4 position = u_projection * vec4(a_position, 1);\n  float inverse = 1.f / (1.f - position.z * .2f);\n\n  vec4 result = vec4(position.x, -inverse * position.y * (1.f - .5f * position.z), inverse * position.z, inverse * position.w);\n  gl_Position = result;\n  \n  v_texturePosition = a_texturePosition;\n}"),f=
new ka({a,type:"fragment"},"#version 300 es\nprecision mediump float;\n\nuniform sampler2D u_texture;\nuniform float u_threshold;\n\nin vec2 v_texturePosition;\nout vec4 output_color;\n\nvoid main() {\n    vec4 color = texture(u_texture, v_texturePosition.st);\n    color.a -= u_threshold;\n    if (color.a <= u_threshold) {\n        discard;\n    }\n    output_color = color;\n}");const h=new ma({a,P:"projection"});la(h,d,f).link();d=a.createTexture();a.bindTexture(a.TEXTURE_2D,d);a.texImage2D(a.TEXTURE_2D,
0,a.RGBA,b,c,0,a.RGBA,a.UNSIGNED_BYTE,null);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);f=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,f);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,d,0);a.bindFramebuffer(a.FRAMEBUFFER,null);const g=128/e;e=xa({name:"fade",width:64,height:64,a,da:Xa(e)});this.c=h;this.b=ya({Ka:d,name:"lighting",
width:b,height:c,a});this.W=f;this.H=new L(e,{main:[[g,0,-g,1,0,g,0,g,1,1,-g,0,-g,0,0,-g,0,g,0,1]]})}}function Va(a,b,c,e){e.Ba?a.clearColor(0,0,0,1):a.clearColor(0,0,0,.2);a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);e.Ga(a,b,()=>{const d=c.H;G(d,b);const f=b.l.threshold,h=e.La;e.Fa.forEach(g=>{if(!g.h){var k=g.startTime;k=(h-k)/(g.fa-k);a.uniform1f(f,.5*k*k);z(b.stack,g.x,g.y,g.z);K(d,"main",0);b.stack.pop()}})})}
function Xa(a){const b=new Uint8Array(16384),c=(f,h)=>{f/=a;h/=a;return f*f+h*h},e=Math.min(c(32,0),c(32,0));for(let f=0;64>f;f++)for(let h=0;64>h;h++){const g=4*(64*f+h);var d=c(h-32,f-32);const k=1-Math.sqrt(d/e);d=1E-4>=d?5:0;const l=Math.max(Math.round(255*k*k),0);b[g]=d+Math.max(Math.round(20*k),0);b[g+1]=d;b[g+2]=d;b[g+3]=l}return b};async function Ya(a){const [b,c]=await Promise.all([a("creature","assets/Enemy.png"),a("tentacle","assets/Tentacle.png")]);a=new L(b,{blink:Ca({x:.15,z:.15,width:.3,height:.3,aa:108/b.w,$:108/b.f,g:2,count:6})});var e=Array(6).fill(.125);e[0]=4;a=Ba({name:"creature_normal",set:a,ha:["blink"],Ca:!0,ga:e});e=[];var d=92,f=-22;const h=Math.sqrt(d*d+f*f);d/=h;f/=h;for(let g=0;29>g;g++){const k=g%5,l=Math.floor(g/5),n=[],u=(y,r)=>{const A=100*y,D=77*r-48;n.push((A*d+D*f)/h,y,(A*-f+D*d)/360/2,100*(k+y)/
c.w,77*(l+r)/c.f)};u(1,1);u(0,1);u(1,0);u(0,0);e.push(n)}e=new L(c,{wiggle:e});return{Da:a,Ja:e}}class Za{constructor(a,b,c,e){const d=a.pa.ea.Da();a=a.I;if(!d.va.includes("blink"))throw Error(`${d} does not have mode ${"blink"}`);d.R=0;d.ba="blink";d.S=0;d.U=Aa(d,0,a);this.x=this.Ia=b;this.y=c;this.z=e;this.ma=this.na=0;this.Z=[$a(0,b,c,-1,1),$a(1,b,c,-1,-1),$a(2,b,c,1,1),$a(3,b,c,1,-1)];this.Ha=d}}
function ab(a){const b=a.I;a.L.forEach(c=>{c.x=c.Ia+.5*Math.sin(b);var e=.5*Math.cos(b);if(b>c.na){var d=c.ma;c.ma=(d+1)%c.Z.length;d=c.Z[d];e=c.x+.225*e+d.za;.05<Math.abs(e-d.O)&&(c.na=b+.125,d.la=b+.125,d.ia=d.O,d.ja=d.X,d.ka=d.Y,d.O=e,d.X=c.y+d.Aa,d.Y=0)}})}
function bb(a,b){const c=a.stack,e=b.pa.ea.Ja,d=b.I;b.L.forEach(f=>{z(c,f.x,f.y,f.z);{f=f.Ha;const h=f.ba;if(null==h)throw Error(`${f} tried rendering while inactive`);let g=f.S;const k=f.U;-1!==k&&k<=d&&(++g===f.b.length&&(g=0,f.R++),f.S=g,f.U=Aa(f,g,d));G(f.c,a);K(f.c,h,g)}c.pop()});G(e,a);b.L.forEach(f=>{const h=f.z-.04;f.Z.forEach(g=>{var k=f.x+g.wa,l=f.y+g.xa;let n=g.O,u=g.X,y=g.Y;var r=g.la;d<r&&(r=1-(r-d)/.125,n=cb(r,g.ia,k,n),u=cb(r,g.ja,l,u),y=cb(r,g.ka,h,y));k-=n;l-=u;r=h-y;const A=Math.sqrt(k*
k+l*l+r*r);z(c,n,u,y);ea(c,0<k?Math.atan(r/k):0===k?0<r?Math.PI/2:0===r?0:-Math.PI/2:Math.atan(r/k)+Math.PI);c.push(new Float32Array([A,0,0,0,0,l,0,0,0,0,1,0,0,0,0,1]));K(e,"wiggle",Math.abs((Math.floor(24*d)+g.ya)%57+1-29));c.pop();c.pop();c.pop()})})}function $a(a,b,c,e,d){const f=.2*e,h=.1*d;b+=f;c+=h;return{index:a,wa:.05*e,xa:.05*d,za:f,Aa:h,la:0,ia:b,ja:c,ka:0,O:b,X:c,Y:0,ya:0}}function cb(a,b,c,e){return a*(a*e+(1-a)*c)+(1-a)*(a*c+(1-a)*b)};const db=[{C:422,F:285,J:415,K:353},{C:936,F:367,J:868,K:380},{C:1507,F:311,J:1469,K:318},{C:162,F:948,J:206,K:943},{C:1025,F:934,J:976,K:962}];
function eb(a){const b=1/18/18,c=f=>Math.max(0,Math.min(255,Math.round(256*(1-b*f*f)))),e=[];for(let f=0;2>f;f++)for(let h=0;18>h;h++)for(let g=0;2>g;g++){let k;var d=void 0;let l;d=h+6*g;18>d?(k=255,d=c(d),l=255):l=d=k=0;c(h+6*g);c(h+6*g+1);for(let n=0;2>n;n++)e.push(k,d,d,l)}a=xa({name:"spark",width:72,height:2,a,da:new Uint8Array(e)});return new L(a,{fading:Ca({x:1/180,width:.04,height:2/180,aa:1/18,$:1,g:18,count:18})})}function fb(a,b){return a.h?b.h?0:1:b.h?-1:a.y-b.y}
function gb(a,b){return fetch(b).then(c=>{if(!c.ok)throw Error(`failed to load ${b}`);return c.arrayBuffer()}).then(c=>a.decodeAudioData(c))}
window.onload=async function(){function a(){var p=Math.sin(Math.PI*(v+0)/8)/2+Math.sin(Math.PI*(v+0)/3)/8,q=Math.sin(Math.PI*(v+170)/8)/2+Math.sin(Math.PI*(v+130)/3)/8;fa=Math.asin((p-q)/100);Ea=Math.cos(fa);Fa=Math.sin(fa);Ga=(p+q)/2;p=0;E===na&&v-M<5/S||(Pa(k,"attack")?(E=na,M=v,S=12,N&&N.stop(),q=H.createBufferSource(),q.buffer=Ha[Math.floor(Math.random()*Ha.length)],q.connect(H.destination),q.start(0)):(p=1.2*Ra(k,"left","right"),V=p*B,0!==V?(W+=V,X=0>V,E!==Ia&&(E=Ia,M=v,S=8)):E!==oa?(E=oa,M=
v,S=12):null==N&&M<v-4&&(N=H.createBufferSource(),N.buffer=hb,N.connect(H.destination),N.start(0))));q=Math.floor(48*v)-Math.floor(48*(v-B));for(let m=0;m<q;m++){let C=W+(ib-(V?.05:0))*(X?-1:1),I=.1*Math.sin(2*Math.PI*Math.random());var x=328/360,t=Math.PI/2;if(E===na){x=Math.floor(S*(v-M));t=db[x];C=W+(t.C-(x%3*644+284))*(X?-1:1)/360;I=-Math.abs(I);x=(565-(t.F-565*Math.floor(x/3)))/360;var O=(t.J-t.C)*(X?-1:1);t=Math.atan((t.F-t.K)/O);0<O&&(t+=Math.PI)}O=Math.PI/4*(Math.random()-.5)+t;const Y=2*
Math.random()+1.4;t=Y*Math.sin(O);O=Y*Math.cos(O)+p;100<P.length&&P.pop();P.push({h:!1,x:C,y:0,z:x,i:O,G:I,o:t,startTime:v,fa:v+1.5,oa:!1})}const jb=9.8*Ea*B,kb=9.8*Fa*B,Ja=1-.8*B;P.forEach(m=>{var C=m.h;if(!C&&v<m.fa){m.x+=m.i*B;m.y+=m.G*B;m.z+=m.o*B;C=m.o;m.oa?(m.i*=Ja,m.G*=Ja):(C-=jb,m.i-=kb,m.o=C);const I=m.y;if(-.5>I||.5<I){const Y=0<I?.5:-.5;m.y=Y+(Y-I);m.G=-m.G}0>m.z&&(-.01<C?(m.z=180,m.o=0,m.oa=!0):(m.z=-m.z,m.o=-.25*C))}else C||(m.h=!0)});P.sort(fb);ab(T)}function b(p,q,x){da(q.stack,D);
z(q.stack,-4,0,-A);ea(q.stack,fa);z(q.stack,0,0,Ga);x(p,q);q.stack.pop();q.stack.pop();q.stack.pop()}function c(p,q){const x=q.stack;G(Ka,q);K(Ka,"main",0);G(La,q);K(La,"main",0);G(Ma,q);K(Ma,"main",0);z(x,W,0,0);G(E,q);K(E,X?"left":"right",Math.floor(S*(v-M)));x.pop();bb(q,T);G(Na,q);P.forEach(t=>{t.h||(z(x,t.x,t.y,t.z),ea(x,(0<=t.i?Math.PI:0)+Math.atan(t.o/t.i)),K(Na,"fading",Math.floor(12*(v-t.startTime))),x.pop(),x.pop())})}function e(p,q){p.bindFramebuffer(p.FRAMEBUFFER,null);p.viewport(0,0,
y,r);p.disable(p.BLEND);p.clearColor(0,0,0,1);p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT);p.activeTexture(p.TEXTURE1);pa.b.bindTexture();p.uniform1i(q.l.lighting,1);p.activeTexture(p.TEXTURE0);b(p,q,c)}function d(){{const p=(Date.now()-lb)/1E3;B=p-T.I;v=T.I=p;ha=-1===ha?60:1/B/16+.9375*ha;f.innerHTML=`fps=${Math.round(ha)}`}Qa(k)%2&&(n=!n);!qa&&Pa(k,"fullscreen")&&(qa=h.requestFullscreen());A+=B*Ra(k,"down","up");window.cameraZ=A;a();Ua(pa,{Ga:b,La:v,Fa:P,Ba:n});ua(U,e);requestAnimationFrame(d)}
const f=document.getElementById("fps"),h=document.getElementById("canvas");var g=window.getComputedStyle(h);const k=new Sa(document.body);R(k,"left",["a","ArrowLeft"]);R(k,"right",["d","ArrowRight"]);R(k,"showLights",["l"]);R(k,"attack",["f"," "]);R(k,"fullscreen",["u"]);R(k,"up",["w","ArrowUp"]);R(k,"down",["s","ArrowDown"]);var l=parseInt(g.getPropertyValue("width"),10);g=parseInt(g.getPropertyValue("height"),10);let n=!1;var u=window.devicePixelRatio||1;const y=u*l,r=u*g;h.width=y;h.height=r;let A=
.948;const D=new Float32Array([360/l,0,0,0,0,0,1,0,0,2/(g/180),0,0,0,0,0,1]),w=h.getContext("webgl2",{antialias:!1,alpha:!1});w.enable(w.DEPTH_TEST);w.depthFunc(w.LEQUAL);l=new ka({a:w,type:"vertex"},"#version 300 es\nin vec3 a_position;\nin vec2 a_texturePosition;\n\nuniform mat4 u_projection;\n\nout vec4 v_clipSpace;\nout vec2 v_texturePosition;\n\nvoid main() {\n    vec4 position = u_projection * vec4(a_position, 1);\n    float inverse = 1.f / (1.f - position.z * .2f);\n\n    vec4 result = vec4(position.x, inverse * position.y * (1.f - .5f * position.z), inverse * position.z, inverse * position.w);\n    gl_Position = result;\n    \n    v_clipSpace = result;\n    v_texturePosition = a_texturePosition;\n}");
g=new ka({a:w,type:"fragment"},"#version 300 es\nprecision mediump float;\n\nuniform sampler2D u_texture;\nuniform sampler2D u_lighting;\n\nin vec2 v_texturePosition;\nin vec4 v_clipSpace;\nout vec4 output_color;\n\nvoid main() {\n    vec4 clipSpace = vec4(.5f * (v_clipSpace.x + 1.f), -.5f * (v_clipSpace.y - 1.f), v_clipSpace.z, v_clipSpace.w);\n\n    vec4 color = texture(u_texture, v_texturePosition.st);\n    if (color.a == 0.0) {\n        discard;\n    }\n\n    vec4 light = texture(u_lighting, clipSpace.xy);\n    vec3 math = min(light.xyz + color.xyz * light.a, vec3(1.f, 1.f, 1.f));\n    output_color = vec4(math, color.a);\n}");
const U=new ma({a:w,P:"projection"});la(U,l,g).link();const pa=new Wa(w,y,r,360),H=new AudioContext;l=(p,q)=>F({a:w,name:p,src:q});const [Z,ia,ra,sa,ta,Ha,hb,mb,J]=await Promise.all([F({a:w,src:"assets/Back Wall.png",name:"wall"}),F({a:w,src:"assets/new floor Floor.png",name:"floor"}),F({a:w,src:"assets/Hero Breathing with axe.png",name:"idle"}),F({a:w,src:"assets/Hero Walking with axe.png",name:"walk"}),F({a:w,src:"assets/Axe Chop.png",name:"attack"}),Promise.all([gb(H,"assets/Grunt1.mp3"),gb(H,
"assets/Grunt2.mp3"),gb(H,"assets/Grunt3.mp3")]),gb(H,"assets/Theres something here.mp3"),Ya(l),l("ceiling","assets/New Ceiling.png")]);let N=null;l=52/ia.f;g=ia.w/360;u=38/360;var Oa=218/ia.f;const Ka=new L(Z,{main:[[Z.w/360,.5,Z.f/360,1,0,Z.w/360,.5,0,1,1,0,.5,Z.f/360,0,0,0,.5,0,0,1]]}),La=new L(ia,{main:[[g,-.5,-u,1,1,0,-.5,-u,0,1,g,-.5,0,1,Oa,0,-.5,0,0,Oa,g,.5,0,1,l,0,.5,0,0,l]]});l=J.w/360;const Ma=new L(J,{main:[[l,-.5,2+62/360,1,0,0,-.5,2+62/360,0,0,l,-.5,2,1,62/J.f,0,-.5,2,0,62/J.f,l,.5,2,
1,266/J.f,0,.5,2,0,266/J.f,l,.5,2+-70/360,1,336/J.f,0,.5,2+-70/360,0,336/J.f]]});l=220/405;const ib=1.125*(387/405-l),oa=new L(ra,{right:Q({D:l,B:405,u:434,A:ra,v:360,g:5,count:16}),left:Q({D:1-l,B:405,u:434,A:ra,v:360,g:5,count:16,j:!0})}),Ia=new L(sa,{right:Q({D:258/424,B:424,u:444,A:sa,v:360,g:2,count:8}),left:Q({D:1-258/424,B:424,u:444,A:sa,v:360,g:2,count:8,j:!0})}),na=new L(ta,{right:Q({D:284/644,B:644,u:565,A:ta,v:360,g:3,count:5}),left:Q({D:1-284/644,B:644,u:565,A:ta,v:360,g:3,count:5,j:!0})});
new L(pa.b,{main:[Da({width:2,height:1,sa:0,ta:0,qa:1,ra:1})]});const T={pa:{ea:mb},L:[],I:0},Na=eb(w),P=[];let lb=Date.now(),v=0,ha=-1,B=0,W=4,V=0,X=!1,M=0,E=oa,S=12,qa=null;document.addEventListener("fullscreenchange",()=>{document.fullscreenElement||(qa=null)});T.L.push(new Za(T,W+2,0,.2));let fa,Fa,Ea,Ga;requestAnimationFrame(d);h.onmousemove=()=>{}};
